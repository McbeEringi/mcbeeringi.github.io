//https://github.com/aFarkas/requestIdleCallback/tree/0.3.0
!function(e){"function"==typeof define&&define.amd?define([],e):"object"==typeof module&&module.exports?module.exports=e():window.idleCallbackShim=e()}(function(){"use strict";var e,t,n,i,o,u,a,l,r="undefined"!=typeof window?window:null!=typeof global?global:this||{},c=r.cancelRequestAnimationFrame&&r.requestAnimationFrame||setTimeout,d=r.cancelRequestAnimationFrame||clearTimeout,s=[],m=0,f=!1,b=7,v=35,p=125,w=0,g=0,k=0,h={get didTimeout(){return!1},timeRemaining:function(){var e=b-(Date.now()-g);return e<0?0:e}},y=(o=function(){b=22,p=66,v=0},l=function(){var e=Date.now()-a;e<99?u=setTimeout(l,99-e):(u=null,o())},function(){a=Date.now(),u||(u=setTimeout(l,99))});function C(){125!=p&&(b=7,p=125,v=35,f&&(f&&(i&&d(i),n&&clearTimeout(n),f=!1),I())),y()}function q(){i=null,n=setTimeout(E,0)}function D(){n=null,c(q)}function I(){f||(t=p-(Date.now()-g),e=Date.now(),f=!0,v&&t<v&&(t=v),t>9?n=setTimeout(D,t):(t=0,D()))}function E(){var i,o,u,a=b>9?9:1;if(g=Date.now(),f=!1,n=null,m>2||g-t-50<e)for(o=0,u=s.length;o<u&&h.timeRemaining()>a;o++)i=s.shift(),k++,i&&i(h);s.length?I():m=0}function T(e){return w++,s.push(e),I(),w}function L(e){var t=e-1-k;s[t]&&(s[t]=null)}if(r.requestIdleCallback&&r.cancelIdleCallback)try{r.requestIdleCallback(function(){},{timeout:0})}catch(e){!function(e){var t,n;if(r.requestIdleCallback=function(t,n){return n&&"number"==typeof n.timeout?e(t,n.timeout):e(t)},r.IdleCallbackDeadline&&(t=IdleCallbackDeadline.prototype)){if(!(n=Object.getOwnPropertyDescriptor(t,"timeRemaining"))||!n.configurable||!n.get)return;Object.defineProperty(t,"timeRemaining",{value:function(){return n.get.call(this)},enumerable:!0,configurable:!0})}}(r.requestIdleCallback)}else r.requestIdleCallback=T,r.cancelIdleCallback=L,r.document&&document.addEventListener&&(r.addEventListener("scroll",C,!0),r.addEventListener("resize",C),document.addEventListener("focus",C,!0),document.addEventListener("mouseover",C,!0),["click","keypress","touchstart","mousedown"].forEach(function(e){document.addEventListener(e,C,{capture:!0,passive:!0})}),r.MutationObserver&&new MutationObserver(C).observe(document.documentElement,{childList:!0,subtree:!0,attributes:!0}));return{request:T,cancel:L}});
